generator client {
  provider = "prisma-client"
  output   = "../generated"
  moduleFormat = "cjs"
}

datasource db {
  provider = "postgresql"
}

model AddressBook {
  id          Int        @id() @default(autoincrement())
  createdAt   DateTime   @map("created_at") @db.Timestamp(6)
  updatedAt   DateTime   @map("updated_at") @db.Timestamp(6)
  userAddress String     @map("user_address") @db.VarChar
  name        String     @db.VarChar
  address     String     @db.VarChar
  email       String?    @db.VarChar
  token       Json?      @db.Json
  order       Int        @default(autoincrement())
  categoryId  Int        @map("categoryId")
  categories  Categories @relation(fields: [categoryId], references: [id], onDelete: SetNull, onUpdate: NoAction)

  @@map("address_book")
}

model Categories {
  id           Int               @id() @default(autoincrement())
  createdAt    DateTime          @map("created_at") @db.Timestamp(6)
  updatedAt    DateTime          @map("updated_at") @db.Timestamp(6)
  name         String            @unique() @db.VarChar
  shape        CategoryShapeEnum @default(CIRCLE)
  color        String            @db.VarChar
  order        Int               @default(autoincrement())
  ownerAddress String            @map("owner_address") @db.VarChar
  addressBook  AddressBook[]

  @@index([order])
  @@map("categories")
}

model PaymentLink {
  id             Int                   @id() @default(autoincrement())
  code           String                @unique() @map("code") @db.VarChar
  createdAt      DateTime              @map("created_at") @db.Timestamp(6)
  updatedAt      DateTime              @map("updated_at") @db.Timestamp(6)
  title          String                @db.VarChar
  description    String                @db.VarChar
  amount         String                @db.VarChar
  status         PaymentLinkStatusEnum @default(ACTIVE)
  order          Int                   @default(autoincrement())
  payee          String                @db.VarChar
  records        PaymentLinkRecord[]
  acceptedTokens Json?                 @map("accepted_tokens")
  acceptedChains Json?                 @map("accepted_chains")

  @@index([code])
  @@index([payee])
  @@index([order])
  @@map("payment_link")
}

model PaymentLinkRecord {
  id            Int         @id() @default(autoincrement())
  createdAt     DateTime    @map("created_at") @db.Timestamp(6)
  updatedAt     DateTime    @map("updated_at") @db.Timestamp(6)
  payer         String      @db.VarChar
  txid          String?     @map("txid") @db.VarChar
  paymentLinkId Int         @map("payment_link_id")
  PaymentLink   PaymentLink @relation(fields: [paymentLinkId], references: [id])
  token         Json?
  chain         Json?

  @@map("payment_link_record")
}

model Notifications {
  id            Int                     @id() @default(autoincrement())
  createdAt     DateTime                @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt     DateTime                @default(now()) @map("updated_at") @db.Timestamp(6)
  title         String
  message       String?
  type          NotificationsTypeEnum
  status        NotificationsStatusEnum @default(UNREAD)
  metadata      Json?
  actionUrl     String?                 @map("action_url") @db.VarChar
  walletAddress String                  @map("wallet_address") @db.VarChar
  readAt        DateTime?               @map("read_at") @db.Timestamp(6)

  @@index([status])
  @@index([type])
  @@index([walletAddress])
  @@index([walletAddress, createdAt])
  @@index([walletAddress, status])
  @@map("notifications")
}

enum CategoryShapeEnum {
  CIRCLE
  DIAMOND
  SQUARE
  TRIANGLE
}

enum NotificationsStatusEnum {
  UNREAD
  READ
}

enum NotificationsTypeEnum {
  NOP
}

enum PaymentLinkStatusEnum {
  ACTIVE
  DEACTIVATED
}
